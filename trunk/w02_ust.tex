%
\chapter{移动泛在环境中的分布式终端技术}\label{ch:ust}

\section{引言}

移动通信系统在过去的~20~年中，已经发展到第三代，它给人们的行为方式所带来的变化让人叹为观止，移动终端已经成为了人们生活的一个不可缺少的部分，以移动通信发展比较先进的欧盟国家为例，截至到~2006~年~12~月~31~日，手机数量已经达到~4.784~亿部，手机普及率超过~$100\%$~达到~$103.2\%$，而移动终端本身的功能也不再是简单的通信了。由于移动终端相对于固定终端具有位置可变性和很强的个人性，移动业务也从传统的通信服务扩展到了围绕移动用户的全面的个人信息服务乃至金融服务。

尽管网络层全IP的趋势已经非常明显了，而且各个标准化组织都在将它的体系结构向全IP发展，但在网络层以下，却不存在这样一个统一的趋势。在各种第三代移动通信系统制式先后成熟进入商用阶段之后，数据传输速率大大超过~IMT-2000~规定的增强技术，如~HSDPA~也开始部分商用，此外，传统的无线数据接入技术如~WLAN~和~WiMAX~也开始介入移动业务领域，而同时，传统的第二代移动通信系统也不会迅速退出历史的舞台，未来的网络不可能拥有统一的空中接口技术。

网络技术多样化的原因在于：统一的空中接口固然会带来很多便利，但这些便利面临着很多挑战，不论从技术上还是经济上都是如此。各种无线通信技术都有各自的特点，没有一种技术可以在任何条件下满足用户的需求。正如前文刚刚提到的，第三代蜂窝网络能让用户即使在数百公里每小时的高速运动中仍然接受到连续稳定的网络业务，却难以为用户在静止状态下提供数十兆比特每秒的~Internet~网络访问；超宽带~(UWB)~技术可以提供在几米范围内的~Gbps~级的传输速率，却不能提供大范围的覆盖。组网方式的不同、传输技术的差异，使得各种技术都将在未来的无线通信领域占据一席之地。而从经济上考虑，网络接入提供商或运营商在过去的时间中，已经投入巨资部署了各自的网络，他们会尽量利用已有的网络来提供服务，而不是更换网络设备。因此，在未来的网络中，即使是充当同一种角色的网络~(如蜂窝网络)，也不会只有一种制式的。 因此，网络的异构性是未来移动通信系统的基本特征之一。

网络技术异构化正在促进着业务环境的统一化。由于网络的异构性，用户将更频繁地在不同的网络中迁移，同时处于若干个不同网络的覆盖下的情况也将更为普遍。在这样的条件下，用户总是希望能够得到无缝的、一致的服务。在第三代移动通信系统中，已经出现了虚拟归属环境~(VHE)~这样的概念和开放业务接入~(OSA)~这样的网络应用接口，希望能够支持更广泛的移动，让用户在不同网络间迁移的时候可以享受到一致的业务展现，而不关心不同的网络是如何实现业务的。因此，在未来的网络中，统一化的业务环境所追求的目标将是，依据环境情况~(网络、终端、业务)，为用户提供其个人意义上的最佳服务，这里的最佳是根据不同用户偏好的一个综合的量度，而不是单一的性能指标。

网络异构化加剧的另一个后果是终端对多种接入网制式的支持正在从多模式向重配置/重构~(reconfiguration)~转移，因为网络的异构性，终端必须能够接入多个网络，在这种条件下，软件定义无线电~(SDR)~技术以其理论上无限多种网络的接入能力成为了研究的焦点，但是单一终端的射频部分的硬件实现是对~SDR~终端的一个限制，射频器件能够提供的工作范围毕竟是有限的。而且，尽管目前的终端正在集成越来越多的数据采集和媒体功能，但单一终端的体积、集成度以及成本限制使其难以在兼顾便携性的同时具有更好的业务展现效果。

而个人周边，在广域移动通信网络的接入技术向着更高速率、更高频谱利用率的方向，业务环境向着统一化演进的同时，短距离无线传输与网络技术也取得了飞速的进展，UWB~通信到低功耗的~ZigBee，从智能家电的互联到可穿戴网络，从精密的传感器到廉价的~RFID~标签，这些个人域的设备正在在人们周边构造一个``智能空间''，服务着人们社会生活，也让~Mark Weiser~所预见的泛在计算愿景离我们越来越近。

综合考虑移动终端的重构化趋势与个人周边设备智能化的趋势，我们可以转换思路，不再拘泥于单一便携设备的功能提升，转而利用个人周边各具不同能力的智能设备的协作，聚合重构为一个分布式的终端，不仅可以在功能上满足跨越多种接入网的无缝切换/漫游能力，更可以综合周边智能空间中的设备能力，收集更多用户上下文，提供更丰富的业务功能和更好的业务体验，进一步融入统一而且外延更加广泛的业务环境之中。

\section{分布式移动终端技术的已有研究}

早在~1998~年，爱立信、IBM、Intel、诺基亚和东芝就联手创立了蓝芽特别兴趣组~(SIG)，开始利用无线手段，为手持终端和其他个人移动计算设备进行功能扩展，利用蓝芽技术，终端可以无线地访问耳机、打印机、相机、GPS~接收机等外设，开始将终端的功能分布化。但是，蓝芽中的设备分工十分明确，主机和外设具有明显的界定\footnote{使用蓝芽网络封装协议~(BNEP)，也可以利用蓝芽底层承载，构建对等的计算机个域网，但这不在本文的考虑范围。}，智能性只体现在终端本身上，并没有涉及到个人域智能设备的协作，还没有构成我们所讨论分布式终端。

Telenor~的~Erik Vanem~等人在~2002~年提出了``虚拟终端''的概念，作为虚拟归属环境~(VHE)~的一个扩展。这里的所谓``虚拟终端''，实际是一个网络服务，用户周边的每个设备都彼此独立地接入网络，并在这一服务当中注册，这样，用户就可以利用所有这些设备的功能，例如摄像、视频播放等，来使用多媒体服务。Vanem~等的``虚拟终端''服务可以利用~Parlay/OSA API~或是~Web Service~等业务控制方法来实现，对于多媒体业务的应用来说，这种实现具有一些优点:
\begin{itemize}
	\item 直接利用已有网络和终端设备，实现简单。
	\item 可以同时利用多个终端的接入能力，一定程度地增加多媒体承载能力。
\end{itemize}
不过，``虚拟终端''~服务没有利用设备之间的互联能力和协作带来的能力上的提升，在面对移动泛在业务的时候可能会遇到一些挑战：
\begin{itemize}
	\item 在移动泛在业务之中，每个用户在业务中都可能利用到数十乃至上百的信息传感器和其他各种计算或业务执行设备，这些设备可能十分简单不具备网络接入能力，并且，由于数量众多在网络服务中为每个用户维护所有设备的属性描述和状态信息将会十分困难。
	\item 所有设备的信息都未经处理地直接传送给网络会造成不必要的流量需求，影响业务服务质量。
\end{itemize}

Tore J\o{}nvik~等人还提出了一种基于个人域网络~(PAN)~的~``虚拟设备''，通过中间件技术来让个域网中的设备成为一个整体，将个域网中的设备与网络彻底隔离，在这样的情况下，个人域网络中的多个具有接入能力的设备对于网络和业务来说，彼此是没有关系的，从而也让网络无法对这些设备进行优化配置。在网络层上，建立在移动~IP~基础上的网络移动性~(NEMO, Network Mobility)~的研究考虑了这一问题，但由于在网络层上能够获得的关于用户的上下文信息十分有限，很难解决以用户为中心的设备相关性，举例来说，某些设备可能同时或不同时地隶属于不同用户，在这种情况下，通过~IP~地址来区分所属关系就变得十分困难。

欧盟~IST~中的~MAGNET~项目中引入了另一个类似概念――~``个人网络~(PN, Personal Network)''，PN~不再局限于物理位置上的相关性，把个人相关的设备们全部通过网络连接在一起，也就是说，把个人从距离这个一维相关性扩展到了~``业务上下文''~的多维相关性上，极大扩展了个人周边的概念。而在~PN~当中，加入到个人网络中的也包括随用户移动的个人域网络，即个人域网络由于其连接性，仍是考虑个人中心业务的基本元素。

\begin{figure}[tb]
	\begin{center}
		\includegraphics[width=.7\textwidth]{illu_2}
	\end{center}
	\caption{``统一业务终端技术''~项目中分布式终端的应用场景}
	\label{fig:ust-illu}
\end{figure}

在跟踪国外研究的同时，作者所在的研究团队也同时展开了终端分布化方面的研究，并在国家~863~计划支持的~``统一业务终端技术''~和~``移动网格''~等项目之中，利用分布式中间件技术和短距离无线通信技术，设计了一个可以跟随用户移动、利用个人周边的智能设备和各种可用的广域网络，连续、一致地为用户提供服务~(图~\ref{fig:ust-illu})。在考虑了网络的功能抽象化，进一步将分布式终端所提供的业务环境与网络的业务能力进行架构上的统一、融合，进而提出了~``移动泛在业务环境~(MUSE)''~为下一步融合通信系统的演进指明了愿景。

\section{聚合重构分布式终端}

从已有研究可以看出，分布式的重构终端中的~``重构''~定义与重构概念提出之初相比，其范畴有一个飞跃式的扩展――从根据接入条件的变化被动调整终端自身的接入参数以适应其变化，进而到主动聚合个人周边的智能设备的包括但不限于接入能力的各种业务能力，不但适应变化，同时提供更多的业务元素。因此，我们将这种的分布式的重构行为定义为~``聚合重构''~，而将早期的~``重构''~归纳为~``适配重构''~以示区别。

聚合重构分布式终端~(以下简称分布式终端)~是在周边智能设备上构建一个中间件层，该中间件可以维持设备间的组织，协助业务发现并利用可用业务资源。由于该中间件层分布式运行于用户的周边智能之上，因此，需要具有如下特点:
\begin{itemize}
	\item 由于用户周边设备自身的稳定性较低且用户操作的不确定性较高，中间件应具有较高的容错性，终端系统相关数据应具有较高冗余度。
	\item 由于用户在使用业务期间可能大范围移动，部分设备可能会始终跟随用户，而其它设备则可能中途加入或退出，因此，中间件应具有较强的动态组织能力和健壮的服务发现机制。
	\item 由于不同设备的能力具有较大的差异性，支持的互联方式也有所不同，中间件需要考虑到从传输到处理与存储能力上的异构性。
\end{itemize}

综上，本论文所述分布式终端系统的中间件基于对不同设备的业务资源的抽象，在异构个人域网络上对设备进行自组织，向业务提供一组一致的业务资源调用接口，并适应环境的变化。

\subsection{个人域设备的抽象}

参照~Parlay/OSA~中对网络功能的抽象方法，在分布式终端之中，每个逻辑上的功能都被抽象为一个~``终端业务能力特征~(CF, Capability Feature)''，例如视频播放、音频采集、IP~网络连接等，每个能力特征都具有一组属性，定义一个能力特征的属性包括
\begin{itemize}
	\item 功能属性：如视频播放能力特征支持何种编码的视频，加密能力特征支持何种加密算法等。
	\item 能力属性：如网络连接能力特征的时延参数、带宽，图形显示能力特征支持多高的分辨率和刷新率等。
	\item 接口属性：如何将带显示视频码流送入视频播放能力特征，加密能力特征的数据如何送入、如何返回等。
\end{itemize}
分布式终端中的每个设备将其支持的每个能力特征都封装成一个具有属性的``终端业务能力服务器~(CS)''，该能力服务器的属性会作为其描述信息用于服务发现与服务调用。同一个设备可能具有多个能力服务器，同样，不同的设备也可能提供同类能力特征，当然，它们的属性会有一些差异。

在分布式终端中，设备所提供的能力服务器具有如下特征:
\begin{itemize}
	\item 能力服务器之间可能具有依赖或调用关系，如视频播放能力会依赖于图形显示能力，这些依赖和或调用关系可以协助应用合理地选择可用业务资源。
	\item 能力服务器的属性可能受到其它能力服务器的影响，视频编码能力特征的性能会影响视频采集能力所能接收信息的分辨率和刷新率。
	\item 能力服务器可以彼此连接，完成更复杂的功能，如加密能力特征可以和某些其它数据传输类能力特征串联，进行安全传输。
\end{itemize}

为了使每个设备的能力可以被应用所发现、使用，每个设备都需要有一个独立的逻辑功能，把能力服务器的描述信息分发给其它设备、参与分布式终端的服务发现机制，这个逻辑单元被命名为聚合控制~(AC)~功能。

如果一个设备具备了聚合控制功能和一个或多个能力服务器，那么它就具有了成为分布式终端系统的一部分，为应用提供服务的能力了，这样的设备被称作分布式终端系统之中的~``基本节点~(BN, Basic Node)''。此外作为一个整体，分布式终端系统需要一些额外的能力来完成系统级的组织、维护工作，由于不同设备的计算、存储与通信能力的具有较强的差异性，只要有部分设备具有这样的额外能力就可以了，具有这些额外能力的设备被称作~``高级节点~(SN, Senior Node)''，它们所具有的额外功能被成为框架功能~(FW, Framework)。图~\ref{fig:devices}~是分布式终端系统中设备的抽象模型。

\begin{figure}[tb]
	\begin{center}
		\includegraphics[width=.7\textwidth]{device}
	\end{center}
	\caption{分布式终端系统中的设备抽象模型}
	\label{fig:devices}
\end{figure}

\subsection{分布式终端的架构}

从用户的角度看，分布式终端系统是一个始终跟随着他/她的智能周边业务环境，自主地发现、配置、利用周边的智能设备，为他/她提供各种服务。从业务应用的角度看，分布式终端系统是一个业务运行环境，这个运行环境提供了一个服务发现接口，使之可以发现各种可用业务能力，并利用这些能力服务用户。而从设备角度看，分布式终端系统是一个它所参与的自主的分布式系统，它可以与系统的其他成员通信，加入或退出系统，为应用提供包括感知、计算、存储、执行等各种业务能力，对于能力较高的高级节点，还可能参与系统状态的维护和管理。

因此，
在上述个人域设备的上层，分布式终端系统中间件主要完成两个层面的功能：其一是对上层的业务应用提供的调用接口，负责屏蔽底层的分布性、异构性，提供统一的服务发现与业务生成机制；其二是公共服务层，负责维护系统相关的数据信息，记录设备能力的变更。所有这些功能都由分布式终端系统中的高级节点的框架功能来提供。

\subsection{分布式终端系统中的主要机制}

\section{分布式终端的构建}

\subsection{有中心的构建方式}

\subsection{无中心的构建方式}


% vim: set ft=tex:
