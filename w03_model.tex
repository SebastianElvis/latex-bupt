%$Id: w03_spreading.tex  403 2007-02-03 14:09:19Z gnawux $
%  vim: set ft=tex:
\chapter{移动个人网络中的移动性模型}

\section{引言}

本论文所讨论的分布式终端系统，由个人周边的只能设备自组织构成，由于其成员是泛在计算环境下的各种个人周边的智能设备，逻辑中心是其服务的用户，因此，它是构建在一个特殊的自组织网络之上的。由于这个自组织网络的核心――用户具有很强的移动性，随着用户的移动，网络的形态会发生剧烈的变化，而同时，由于这个网络的构建目的十分明确――服务用户，因此，其行为特征也具有很强的特殊性，本文将这种特殊的自组织网络称为~``移动个人网络~(MPN, Mobile Personal Networks)''~以与一般意义的移动自组织网络~(MANET, Mobile Ad hoc Networks)~相区别。

\section{移动个人网络的移动性特征}

不同于通常意义上的~MANET，在移动个人网络中的节点是一些各不相同的设备而不是相同或类似的通用计算机，并且这些节点都围绕在一个用户周围，因此，可以如下概括移动个人网络的基本行为特征：

\begin{enumerate}
	\item 设备能力各有不同，且通过异构网络互联。由于移动个人网络之中的节点都是个人周边的设备，这些设备中可能有计算和连接能力非常强设备，比如电视游戏机，它们可能装备了多核~CPU、千兆以太网以及~WLAN，不过也有的设备非常简单，一些无线传感器可能没什么富余的计算能力，网络连接能力也可能仅仅是~ZigBee~这样的低功耗连接。虽然这些设备在能力上相差悬殊，但在应用中，它们各有用武之地。
	\item 设备之间的距离足够近。在移动个人网络之中，所有可用设备都围绕在用户周围，比如居室、办公室、车内等，对于这样的环境，所有设备间的距离都是足够接近的，影响互相之间的可达性的最主要因素不是距离带来的信号衰落，而是连接上的异构性或是通信制式的容纳能力带来的限制。因此，论文中假设同一链路间的各个设备是互相可达的，跨链路转发则依赖于多模设备。
	\item 设备之间的相互移动行为具有组特征。在~MANET~的组移动性研究中，组往往是由于人员组织等造成的，而个人周边的泛在设备的组移动特征更为显著，这些设备通常都是与生俱来地附属于某一实体的，比如车内的~GPS~导航仪、车载音响、车载电视等，又如居室内的电视、游戏机、温度传感器等。所以，这些设备就是按组移动的，而某一时刻下，个人移动网络总是由一个或若干个组组成的。
\end{enumerate}

\section{自组织网络中的移动性模型}

\section{移动个人网络的分组移动模型}


Nodes in a mobile personal network are moving in group, and nodes in each group may spread in several links. Moreover, the groups in mobile personal networks are hierarchical, for instance, a suit of wearable devices form a group, and they are also in a group of human body when they are worn. Most of previous research on group mobility of MANET adopted the Reference Point Group Mobility (RPGM) \cite{bib:pei1998,bib:hong1999} mobility model and its variants. In RPGM, each group has a conceptual center, the reference point, represents the group's motion. RPGM is an effective approach on research of MANET in which members move as a group, however, the group mobility of MANET does not consider the heterogeneity and the short range nature of mobile personal networks.

A typical mobile personal network is illustrated as Fig.~\ref{fig:mob-mod}. It is a heterogeneous network which consists of several links, and the links are interconnected by some multi-mode nodes named as ``bridge nodes'', which behaves as a router between different links. Based on the analysis in \ref{sse:analysis}, one of the most significant features, which distinguish a mobile personal network from general ad hoc networks, is that packages can be transmitted to any other nodes in the same link within one hop. Thus, if there are $l$ links in a mobile personal network, a piece of informations from one node can be broadcasted to all the others by $l$ messages. Moreover, in mobile personal networks, only the motion leading to joining or leaving of nodes is taken into consideration because a node is able to communicate with any other nodes in the same link once it joins the mobile person network.

\begin{figure}[htb]
	\begin{center}
		\includegraphics[width=.45\textwidth]{mob-mod}
	\end{center}
	\caption{Illustration of a Mobile Personal Network}
	\label{fig:mob-mod}
\end{figure}

\subsection{Service Discovery Procedures Considering Group based Mobility of Nodes}
\label{sec:grp}

\subsection{Control Messages in Service Discovery Procedures}

In proposed protocol, the control messages are sent to all the SNs with multicast, and five classes of control messages are defined:
\begin{itemize}
	\item Advertise. When a node wants to join in the system, or modify its attributes, it may announce itself via ``Advertise''.
	\item Report. If a node has noticed some node disappeared, it
		will report that to its friends with ``Report'' message.
	\item Append. If a node has heard any messages incorrect or 
		incomplete, it will send an ``Append'' message to 
		override or append to them.
	\item Discover. If an application wants to invoke a function, 
		it may send a ``Discover'' message to find a proper
		capability server.
	\item Notify. If a node has found that a CS,
		which had been discovered by an application but not been 
		satisfied, was ready, it will send ``Notify'' message 
		to the application.
\end{itemize}
And several special fields may be contained in the control messages:
The ``\emph{urgency}'' field denotes whether the message is urgent, 
and if it is not, it may be cached and merged with other messages
in order to reduce the noise; and ``\emph{group}'' field implies
that the message may be able to apply to a group if others have no 
opposite message sent.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Device Initiated Procedures}

There are two types of configuration procedures, one is caused by the modifications on devices, and the other is originated by the applications.

When the a device is turned on or normally shutdown, the procedure is considered as a ``single device modification''. As shown in Fig.~\ref{fig:singledev}, a device is announcing that it is turned on and with 2 CSes.

\begin{figure}[htb]
	\texttt{%
Advertise CS JOIN\\
DeviceID: 07707ddd-03d6-46b6-a858-f534e1\\
Urgency: low\\
TTL: 30\\
Servers: 2\\
ServerType: 33dd\\
CAPA: 55\\
ServerType: 49fb\\
CAPA: 45
	}
	\caption{Single Device Modification}
	\label{fig:singledev}
\end{figure}

When a node notices one or more devices are departing from it, which may imply a group is going away, it will send a ``group device modification'' message (Fig. \ref{fig:groupdev}) if no others reported that. In ``group device modification'' message, a hierarchy of groups may be listed, and a latter one must be a subset of a former one. Hence, if any other sends an opposite ``Append message'' against a group (Fig. \ref{fig:append}, the listeners may consider the devices modification is only occurring on its subsets. For instance, the messages in Fig. \ref{fig:groupdev} and \ref{fig:append} shows that \textit{WearableGroup} is a subgroup of \textit{HouseGroup} currently, but \textit{WearableGroup} is going away, while \textit{HouseGroup} stays here, i.e. \textit{WearableGroup} will no longer be a subgroup of it.

\begin{figure}[htb]
	\texttt{%
Report CS LEAVE\\
GroupID: HouseGroup\\
GroupID: WearableGroup\\
Urgency: low\\
TTL: 30\\
DeviceID: 07707ddd-03d6-46b6-a858-f534e1\\
Servers: 2\\
\ldots
	}
	\caption{Group Device Modification}
	\label{fig:groupdev}
\end{figure}

\begin{figure}[htb]
	\texttt{%
Append OPPOSITE LEAVE\\
GroupID: HouseGroup\\
Urgency: low\\
\ldots
	}
	\caption{Append Message}
	\label{fig:append}
\end{figure}

If a node supports multi-mode communication, it will behave as a bridge node, which is responsible for forwarding messages from one link to another. If a ``group device modification'' message is not urgent, the bridge node will not forward it at once, on the contrary, it will wait ``Append'' messages for a while and merge them into the modification message. The bridge operation will introduce a delay
\begin{equation}
	T_b=\max(T_{append})+T_{random},
	\label{eq:bridge}
\end{equation}
where $T_{append}$ is the longest delay of ``Append'' message, and $T_{random}$ is a random delay to avoid collision, even if no ``Append'' message is sent. However, it may prevent from forwarding unnecessary messages. And if the message is tagged as urgency, it will be forward without the $\max(T_{append})$ delay.

\subsection{Application Initiated Procedures}

If an application requires several CSes, it may send a ``Discover Request'' message (Fig. \ref{fig:discover-req}). Then an SN which records the CS satisfying the requirement will reply a ``Discover Response'' message (Fig. \ref{fig:discover-res}). An SN will keep silent if the contents in its record entries have been sent out by others, whereas it will sent an ``Append'' to the response if it has additional information. Moreover, if some CSes do not ready when the application performs a discovery request, the ``Discover Request'' will be refer to as a ``subscribe'' operation, thus, SNs will ``notify'' it whenever the CSes becomes ready. In addition, the notify messages can be sent to nodes with predetermined parameters, which may be used to recompose an application even if the initiate node is not available. 

\begin{figure}[htb]
	\texttt{%
Discover Request\\
ApplicationID: 76ae08ed-7f5d-400f-b931-49c\\
Location: 07707ddd-03d6-46b6-a858-f534e1\\
Urgency: low\\
Servers: 2\\
\ldots
	}
	\caption{Discover Request}
	\label{fig:discover-req}
\end{figure}

\begin{figure}[htb]
	\texttt{%
Discover Response\\
ApplicationID: 76ae08ed-7f5d-400f-b931-49c\\
Location: 07707ddd-03d6-46b6-a858-f534e1\\
Urgency: low\\
Servers: 1\\
\ldots
	}
	\caption{Discover Response}
	\label{fig:discover-res}
\end{figure}

\section{性能分析与仿真}

\subsection{服务发现性能}

\subsection{服务调用性能}


